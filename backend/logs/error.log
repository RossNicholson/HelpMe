{"ip":"::1","level":"error","message":"Not Found - /","method":"GET","service":"helpme-api","stack":"Error: Not Found - /\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at logger (/Users/rossnicholson/HelpMe/backend/node_modules/morgan/index.js:144:5)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9","timestamp":"2025-06-28 14:05:04","url":"/","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15"}
{"code":"28000","file":"miscinit.c","length":100,"level":"error","line":"755","message":"Login error: role \"postgres\" does not exist","name":"error","routine":"InitializeSessionUserId","service":"helpme-api","severity":"FATAL","stack":"error: role \"postgres\" does not exist\n    at Parser.parseErrorMessage (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:285:98)\n    at Parser.handlePacket (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:122:29)\n    at Parser.parse (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:35:38)\n    at Socket.<anonymous> (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/index.js:11:42)\n    at Socket.emit (node:events:507:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-06-28 14:24:44"}
{"code":"28000","file":"miscinit.c","length":100,"level":"error","line":"755","message":"Login error: role \"postgres\" does not exist","name":"error","routine":"InitializeSessionUserId","service":"helpme-api","severity":"FATAL","stack":"error: role \"postgres\" does not exist\n    at Parser.parseErrorMessage (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:285:98)\n    at Parser.handlePacket (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:122:29)\n    at Parser.parse (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/parser.js:35:38)\n    at Socket.<anonymous> (/Users/rossnicholson/HelpMe/backend/node_modules/pg-protocol/dist/index.js:11:42)\n    at Socket.emit (node:events:507:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-06-28 14:24:59"}
{"level":"error","message":"Login error: secretOrPrivateKey must have a value","service":"helpme-api","stack":"Error: secretOrPrivateKey must have a value\n    at module.exports [as sign] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/sign.js:111:20)\n    at generateRefreshToken (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:17:14)\n    at login (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:118:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:27:52"}
{"level":"error","message":"Login error: secretOrPrivateKey must have a value","service":"helpme-api","stack":"Error: secretOrPrivateKey must have a value\n    at module.exports [as sign] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/sign.js:111:20)\n    at generateRefreshToken (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:17:14)\n    at login (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:118:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:31:06"}
{"level":"error","message":"Error getting SLA compliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error in getSLACompliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error getting ticket analytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error in getTicketAnalytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error getting time tracking stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error in getTimeTrackingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error getting client performance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error in getClientPerformance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error getting billing stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error in getBillingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:01"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, \"users\".\"name\" as \"user_name\", \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"created_at\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, \"users\".\"name\" as \"user_name\", \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"created_at\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:154:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:39:03"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, \"users\".\"name\" as \"user_name\", \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"created_at\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, \"users\".\"name\" as \"user_name\", \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"created_at\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:154:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:39:03"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = \"critical\" THEN 1 END) as critical_events, COUNT(CASE WHEN severity = \"high\" THEN 1 END) as high_events, COUNT(CASE WHEN severity = \"medium\" THEN 1 END) as medium_events, COUNT(CASE WHEN action = \"LOGIN\" THEN 1 END) as login_events, COUNT(CASE WHEN action = \"DELETE\" THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"created_at\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = \"critical\" THEN 1 END) as critical_events, COUNT(CASE WHEN severity = \"high\" THEN 1 END) as high_events, COUNT(CASE WHEN severity = \"medium\" THEN 1 END) as medium_events, COUNT(CASE WHEN action = \"LOGIN\" THEN 1 END) as login_events, COUNT(CASE WHEN action = \"DELETE\" THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"created_at\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:194:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:39:03"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = \"critical\" THEN 1 END) as critical_events, COUNT(CASE WHEN severity = \"high\" THEN 1 END) as high_events, COUNT(CASE WHEN severity = \"medium\" THEN 1 END) as medium_events, COUNT(CASE WHEN action = \"LOGIN\" THEN 1 END) as login_events, COUNT(CASE WHEN action = \"DELETE\" THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"created_at\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = \"critical\" THEN 1 END) as critical_events, COUNT(CASE WHEN severity = \"high\" THEN 1 END) as high_events, COUNT(CASE WHEN severity = \"medium\" THEN 1 END) as medium_events, COUNT(CASE WHEN action = \"LOGIN\" THEN 1 END) as login_events, COUNT(CASE WHEN action = \"DELETE\" THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"created_at\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:194:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:39:03"}
{"level":"error","message":"Get SMS settings error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at SMSService.getSMSSettings (/Users/rossnicholson/HelpMe/backend/src/services/smsService.js:149:28)\n    at getSMSSettings (/Users/rossnicholson/HelpMe/backend/src/controllers/smsController.js:10:41)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:05"}
{"level":"error","message":"Get SMS settings error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at SMSService.getSMSSettings (/Users/rossnicholson/HelpMe/backend/src/services/smsService.js:149:28)\n    at getSMSSettings (/Users/rossnicholson/HelpMe/backend/src/controllers/smsController.js:10:41)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:05"}
{"level":"error","message":"Get SMS templates error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at SMSService.getSMSTemplates (/Users/rossnicholson/HelpMe/backend/src/services/smsService.js:196:19)\n    at getSMSTemplates (/Users/rossnicholson/HelpMe/backend/src/controllers/smsController.js:110:42)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:05"}
{"level":"error","message":"Get SMS templates error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at SMSService.getSMSTemplates (/Users/rossnicholson/HelpMe/backend/src/services/smsService.js:196:19)\n    at getSMSTemplates (/Users/rossnicholson/HelpMe/backend/src/controllers/smsController.js:110:42)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:39:05"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:42:58"}
{"level":"error","message":"Error getting ticket analytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getTicketAnalytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting SLA compliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getSLACompliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting SLA compliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getSLACompliance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:53:19)\n    at getSLACompliance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:17:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting time tracking stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getTimeTrackingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting billing stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getBillingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting client performance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getClientPerformance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting time tracking stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getTimeTrackingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:78:19)\n    at getTimeTrackingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:27:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting billing stats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getBillingStats: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getBillingStats (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:113:19)\n    at getBillingStats (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:37:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting client performance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getClientPerformance: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:142:19)\n    at getClientPerformance (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:47:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error getting ticket analytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error in getTicketAnalytics: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at ReportService.getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/services/reportService.js:11:19)\n    at getTicketAnalytics (/Users/rossnicholson/HelpMe/backend/src/controllers/reportController.js:7:40)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)","timestamp":"2025-06-28 14:42:59"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:47:33"}
{"level":"error","message":"Error fetching audit logs: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [audit_logs.organization_id] query: select \"audit_logs\".*, CONCAT(users.first_name, ' ', users.last_name) as user_name, \"users\".\"email\" as \"user_email\" from \"audit_logs\" left join \"users\" on \"audit_logs\".\"user_id\" = \"users\".\"id\" where \"audit_logs\".\"organization_id\" = ? order by \"audit_logs\".\"timestamp\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:153:20)\n    at async getAuditLogs (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:42:20)","timestamp":"2025-06-28 14:47:33"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:47:33"}
{"level":"error","message":"Error fetching audit summary: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_events, COUNT(CASE WHEN severity = 'critical' THEN 1 END) as critical_events, COUNT(CASE WHEN severity = 'high' THEN 1 END) as high_events, COUNT(CASE WHEN severity = 'medium' THEN 1 END) as medium_events, COUNT(CASE WHEN action = 'LOGIN' THEN 1 END) as login_events, COUNT(CASE WHEN action = 'DELETE' THEN 1 END) as delete_events, COUNT(DISTINCT user_id) as active_users from \"audit_logs\" where \"organization_id\" = ? and \"timestamp\" >= ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async AuditService.getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/services/auditService.js:193:23)\n    at async getAuditSummary (/Users/rossnicholson/HelpMe/backend/src/controllers/auditController.js:102:23)","timestamp":"2025-06-28 14:47:33"}
{"ip":"::1","level":"error","message":"Not Found - /api/tickets","method":"GET","service":"helpme-api","stack":"Error: Not Found - /api/tickets\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:646:15\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:265:14)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:50:02","url":"/api/tickets","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15","userId":"a38a0019-ef35-4051-a6d8-363c998bc850"}
{"ip":"::1","level":"error","message":"Not Found - /api/tickets","method":"GET","service":"helpme-api","stack":"Error: Not Found - /api/tickets\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:646:15\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:265:14)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:50:15","url":"/api/tickets","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15","userId":"a38a0019-ef35-4051-a6d8-363c998bc850"}
{"ip":"::1","level":"error","message":"Not Found - /api/tickets","method":"GET","service":"helpme-api","stack":"Error: Not Found - /api/tickets\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:646:15\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:265:14)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:50:15","url":"/api/tickets","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15","userId":"a38a0019-ef35-4051-a6d8-363c998bc850"}
{"ip":"::1","level":"error","message":"Not Found - /api/tickets","method":"GET","service":"helpme-api","stack":"Error: Not Found - /api/tickets\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:646:15\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:265:14)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:53:00","url":"/api/tickets","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15","userId":"a38a0019-ef35-4051-a6d8-363c998bc850"}
{"ip":"::1","level":"error","message":"Not Found - /api/tickets","method":"GET","service":"helpme-api","stack":"Error: Not Found - /api/tickets\n    at notFound (/Users/rossnicholson/HelpMe/backend/src/middleware/notFound.js:2:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:646:15\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:265:14)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 14:53:00","url":"/api/tickets","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15","userId":"a38a0019-ef35-4051-a6d8-363c998bc850"}
{"ip":"::1","level":"error","message":"Not allowed by CORS","method":"POST","service":"helpme-api","stack":"Error: Not allowed by CORS\n    at origin (/Users/rossnicholson/HelpMe/backend/src/server.js:111:16)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:204:7)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at compression (/Users/rossnicholson/HelpMe/backend/node_modules/compression/index.js:243:5)","timestamp":"2025-06-28 15:07:16","url":"/api/auth/register","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15"}
{"ip":"::1","level":"error","message":"Not allowed by CORS","method":"POST","service":"helpme-api","stack":"Error: Not allowed by CORS\n    at origin (/Users/rossnicholson/HelpMe/backend/src/server.js:111:16)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:204:7)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at compression (/Users/rossnicholson/HelpMe/backend/node_modules/compression/index.js:243:5)","timestamp":"2025-06-28 15:07:19","url":"/api/auth/register","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15"}
{"ip":"::1","level":"error","message":"Not allowed by CORS","method":"POST","service":"helpme-api","stack":"Error: Not allowed by CORS\n    at origin (/Users/rossnicholson/HelpMe/backend/src/server.js:111:16)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:204:7)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at compression (/Users/rossnicholson/HelpMe/backend/node_modules/compression/index.js:243:5)","timestamp":"2025-06-28 15:14:28","url":"/api/auth/register","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15"}
{"ip":"::1","level":"error","message":"Not allowed by CORS","method":"POST","service":"helpme-api","stack":"Error: Not allowed by CORS\n    at origin (/Users/rossnicholson/HelpMe/backend/src/server.js:111:16)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/rossnicholson/HelpMe/backend/node_modules/cors/lib/index.js:204:7)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at compression (/Users/rossnicholson/HelpMe/backend/node_modules/compression/index.js:243:5)","timestamp":"2025-06-28 15:14:56","url":"/api/auth/register","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:24:19)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:16:10"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:24:19)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:17:16"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:24:19)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:17:16"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)","timestamp":"2025-06-28 15:20:38"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:23:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:21:17"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:23:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:21:19"}
{"level":"error","message":"Error getting tickets: knex is not a function","service":"helpme-api","stack":"TypeError: knex is not a function\n    at getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:23:17)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:50:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-28 15:21:19"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)","timestamp":"2025-06-28 15:25:16"}
{"level":"error","message":"Token verification failed: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:37:26)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-28 15:25:33"}
{"level":"error","message":"Refresh token error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at refreshToken (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:419:24)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-28 15:25:33"}
{"level":"error","message":"Refresh token error: db is not a function","service":"helpme-api","stack":"TypeError: db is not a function\n    at refreshToken (/Users/rossnicholson/HelpMe/backend/src/controllers/authController.js:419:24)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-28 15:25:33"}
{"level":"error","message":"Error getting tickets: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [tickets.organization_id] query: select \"tickets\".*, \"clients\".\"name\" as \"client_name\", \"creator\".\"first_name\" as \"creator_first_name\", \"creator\".\"last_name\" as \"creator_last_name\", \"assignee\".\"first_name\" as \"assignee_first_name\", \"assignee\".\"last_name\" as \"assignee_last_name\" from \"tickets\" inner join \"clients\" on \"tickets\".\"client_id\" = \"clients\".\"id\" inner join \"users\" as \"creator\" on \"tickets\".\"created_by\" = \"creator\".\"id\" left join \"users\" as \"assignee\" on \"tickets\".\"assigned_to\" = \"assignee\".\"id\" where \"tickets\".\"organization_id\" = ? order by \"tickets\".\"created_at\" desc limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling SELECT. Undefined column(s): [tickets.organization_id] query: select \"tickets\".*, \"clients\".\"name\" as \"client_name\", \"creator\".\"first_name\" as \"creator_first_name\", \"creator\".\"last_name\" as \"creator_last_name\", \"assignee\".\"first_name\" as \"assignee_first_name\", \"assignee\".\"last_name\" as \"assignee_last_name\" from \"tickets\" inner join \"clients\" on \"tickets\".\"client_id\" = \"clients\".\"id\" inner join \"users\" as \"creator\" on \"tickets\".\"created_by\" = \"creator\".\"id\" left join \"users\" as \"assignee\" on \"tickets\".\"assigned_to\" = \"assignee\".\"id\" where \"tickets\".\"organization_id\" = ? order by \"tickets\".\"created_at\" desc limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getTickets (/Users/rossnicholson/HelpMe/backend/src/controllers/ticketController.js:63:21)","timestamp":"2025-06-28 15:52:16"}
{"level":"error","message":"Error getting dashboard stats: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getDashboardStats (/Users/rossnicholson/HelpMe/backend/src/controllers/dashboardController.js:14:25)","timestamp":"2025-06-28 15:54:45"}
{"level":"error","message":"Error getting dashboard stats: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getDashboardStats (/Users/rossnicholson/HelpMe/backend/src/controllers/dashboardController.js:14:25)","timestamp":"2025-06-28 15:54:45"}
{"level":"error","message":"Error getting dashboard stats: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getDashboardStats (/Users/rossnicholson/HelpMe/backend/src/controllers/dashboardController.js:14:25)","timestamp":"2025-06-28 15:55:45"}
{"level":"error","message":"Error getting dashboard stats: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getDashboardStats (/Users/rossnicholson/HelpMe/backend/src/controllers/dashboardController.js:14:25)","timestamp":"2025-06-28 15:55:45"}
{"level":"error","message":"Error getting dashboard stats: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?","service":"helpme-api","stack":"Error: Undefined binding(s) detected when compiling FIRST. Undefined column(s): [organization_id] query: select COUNT(*) as total_tickets, COUNT(CASE WHEN status = 'open' THEN 1 END) as open_tickets, COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_tickets, COUNT(CASE WHEN status = 'closed' THEN 1 END) as closed_tickets, COUNT(CASE WHEN priority = 'high' THEN 1 END) as high_priority, COUNT(CASE WHEN priority = 'urgent' THEN 1 END) as urgent_tickets, COUNT(CASE WHEN due_date < NOW() AND status != 'resolved' AND status != 'closed' THEN 1 END) as overdue_tickets, COUNT(CASE WHEN DATE(created_at) = DATE(NOW()) THEN 1 END) as tickets_today, COUNT(CASE WHEN DATE(resolved_at) = DATE(NOW()) THEN 1 END) as resolved_today from \"tickets\" where \"organization_id\" = ? limit ?\n    at QueryCompiler_PG.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querycompiler.js:112:13)\n    at QueryBuilder_PostgreSQL.toSQL (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/query/querybuilder.js:84:44)\n    at ensureConnectionCallback (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/internal/ensure-connection-callback.js:4:30)\n    at Runner.ensureConnection (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:318:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Runner.run (/Users/rossnicholson/HelpMe/backend/node_modules/knex/lib/execution/runner.js:30:19)\n    at async getDashboardStats (/Users/rossnicholson/HelpMe/backend/src/controllers/dashboardController.js:14:25)","timestamp":"2025-06-28 15:55:46"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:04:10"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:04:10"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)","timestamp":"2025-06-28 16:04:13"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)","timestamp":"2025-06-28 16:04:13"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:04:16"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:04:16"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:04:19"}
{"level":"error","message":"Token verification failed: jwt malformed","name":"JsonWebTokenError","service":"helpme-api","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/rossnicholson/HelpMe/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at protect (/Users/rossnicholson/HelpMe/backend/src/middleware/auth.js:27:27)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/rossnicholson/HelpMe/backend/node_modules/express/lib/router/layer.js:95:5)","timestamp":"2025-06-28 16:07:06"}
